# Crema App - Web ğŸŒ

[![Build Status](https://github.com/cremalab/crema-app-web/workflows/CI/badge.svg)](https://github.com/cremalab/crema-app-web/actions)
[![codecov](https://codecov.io/gh/cremalab/crema-app-web/branch/develop/graph/badge.svg)](https://codecov.io/gh/cremalab/crema-app-web)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

This project includes configuration and tooling that conforms to Crema's baseline best-practices for a Web Application.

**ğŸ§° Tools Used**

- [Create React App](https://facebook.github.io/create-react-app/) for simple configuration ğŸ˜…
- [Cypress](https://www.cypress.io) for end-to-end testing
- [ESLint](https://eslint.org) for code linting
- [Hygen](http://www.hygen.io) for component and util generators
- [Jest](https://jestjs.io) for unit tests
- [Loki](https://loki.js.org) for visual testing
- [Prettier](https://prettier.io) for code formatting (via ESLint plugin)
- [Storybook](https://storybook.js.org) for component playground (and used by Loki)
- [TypeScript](http://www.typescriptlang.org) for Static Typing in JavaScript ([Learn](http://www.typescriptlang.org/docs/handbook/basic-types.html))

## ğŸ— Setup

1. [Install Node/NPM](https://nodejs.org/en/)
2. [Install NVM](https://github.com/creationix/nvm#installation-and-update) (Node Version Manager)
3. `nvm install 'lts/*' && nvm use`
4. `npm i` (install project dependencies)
5. [Install the ESLint plugin for ~~your editor~~ VS Code](https://marketplace.visualstudio.com/items?itemName=dbaeumer.vscode-eslint)
6. Enable "Auto-Fix on Save" in `settings.json`:

```
// There will likely be other settings within this JSON object...
{
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true
  },
  "eslint.validate": [
    "javascript",
    "javascriptreact",
    "typescript",
    "typescriptreact"
  ]
}
```
7. [Install Docker Desktop](https://www.docker.com/products/docker-desktop)

## ğŸ‘Ÿ Run

Run the following scripts with `npm run <SCRIPT_HERE>`:

- `start` - start app
- `new:component` - generate a new component
- `new:util` - generate a new util(ity)
- `test:analyze` - run bundle analyzer
- `test:deps` - run dependency validation tests
- `test:e2e` - run end-to-end tests
- `test:lint:fix` - run linter and fix if possible
- `test:lint` - run linter
- `test:playground` - run component playground (storybook)
- `test:unit:coverage` - run unit tests with coverage
- `test:unit` - run unit tests
- `test:visual:approve` - approve visual changes
- `test:visual:update` - update or create visual references
- `test:visual` - run visual tests (loki)
- `deps:graph` - run dependency validation and generate an SVG representing the dependency graph (requires [`graphviz`](https://graphviz.org/) to be installed on your device)
- `deps:report` - run dependency validation and generate an HTML report

> These scripts are located in `package.json` and do not represent the entirety of available scripts, but are the most commonly used.

## ğŸ› Structure

The `src` directory is where the meat of your app is located. Below is a printout of its file-tree with a description for each part.

```
src
â”œâ”€â”€ assets // Fonts, Images, Etc.
â”‚Â Â  â””â”€â”€ logo.svg
â”œâ”€â”€ components // Create a new one with `npm run new:component`
â”‚Â Â  â””â”€â”€ App
â”‚Â Â      â”œâ”€â”€ __snapshots__ // Generated by Jest from `test.tsx`
â”‚Â Â      â”‚Â Â  â””â”€â”€ test.tsx.snap
â”‚Â Â      â”œâ”€â”€ README.md // Documentation
â”‚Â Â      â”œâ”€â”€ index.css // Styles
â”‚Â Â      â”œâ”€â”€ index.tsx // Main Module Code
â”‚Â Â      â”œâ”€â”€ stories.tsx // Playground stories (npm run test:playground)
â”‚Â Â      â””â”€â”€ test.tsx // Unit Tests (Jest)
â”œâ”€â”€ types // Centralize Type Definitions
â”‚Â Â  â”œâ”€â”€ Entity.ts // Base Type
â”‚Â Â  â”œâ”€â”€ EntityThing.ts // A Sub-Type
â”‚Â Â  â”œâ”€â”€ Id.ts // A Type Alias of `string`
â”‚Â Â  â”œâ”€â”€ MapStateToProps.ts // Includes our `State`
â”‚Â Â  â”œâ”€â”€ State.ts // Redux state interface
â”‚Â Â  â””â”€â”€ Thing.ts // Silly example used by `EntityThing`
â”œâ”€â”€ utils // Create a new one with `npm run new:util`
â”‚Â Â  â”œâ”€â”€ mySpecialUtil
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ __snapshots__ // Generated by Jest from `test.ts`
â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ test.tsx.snap
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ README.md // Documentation
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ index.tsx // Main Module Code
â”‚Â Â  â”‚Â Â  â””â”€â”€ test.tsx // Unit Tests (Jest)
â”‚Â Â  â”œâ”€â”€ decoratorCentered // Used in stories.tsx
â”‚Â Â  â””â”€â”€ shallowRender // Used to render components in test.tsx
â”œâ”€â”€ index.css // Root Styles
â”œâ”€â”€ index.tsx // Root Module
â”œâ”€â”€ react-app-env.d.ts // Definitions from create-react-app
â””â”€â”€ serviceWorker.ts // Documentation
```

## ğŸ¥‡ Best Practices

- Use the code generators:
  - `npm run new:component`
  - `npm run new:util`
  - When prompted for a name, prefer `camelCase` for utils and `CamelCase` for components
- Fill out the `README.md` to describe what your code does
- Run your unit tests `npm run test:unit` while working to see immediate feedback
- If you get stuck at any point, just log an issue and we'll figure it out together ğŸ‘­.
